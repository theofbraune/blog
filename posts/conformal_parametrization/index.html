<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Conformal Parametrization</title><link rel=stylesheet href=../../css/bootstrap.min.css><link rel=stylesheet href=../../css/home.css><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><link rel=icon href=../../images/integral_icon.png></head><body><header id=site-header><nav class="navbar navbar-expand-lg navbar-dark bg-primary"><div class=container-fluid><a class=navbar-brand href=../index.html>Maths of Glory</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class="nav-link active" aria-current=page href=../../>Home</a></li><li class=nav-item><a class=nav-link href=../../posts/index.html>Posts</a></li><li class=nav-item><a class=nav-link href=../../custum/projects/index.html>Projects</a></li></ul></div></div></nav></header><main class=site-main><div class=container><article class=single-post><h1 class="entry-title mt-4 mb-4">Conformal Parametrization</h1><div class="post-meta mb-2"><span class=post-author>Posted by: Jiayi & Theo</span>
<span class=post-date><time>Oct 25, 2022, 4:03PM</time></span>
<span class=post-tags></span></div><div class=entry-content><p>In this TP we want to calculate the harmonic and the conformal parametrization of a mesh.</p><p>You will need to complete the class methods in the class <code>ConformalParametrization</code> that you will find in the header <code>conformal.cpp</code>. In order to see the goal of the TP, you can press 4 to use the pre-build Libigl method of the conformal parametrization on the mesh.<figure><img src=../../images/conformal_parametrization/beetle_after.png width=50% height=50%></figure>A detailed description about the task and further information can be found in the <a href=../../images/conformal_parametrization/lscm_pub_2002.pdf>original publication.</a></p><h3 id=harmonic-parametrization>Harmonic Parametrization</h3><p>As a first step, you should build the matrix for the Dirichlet energy/cotangent Laplacian. The first task will be to implement a harmonic parametrization. In order to do this load the camelhead or the mask file and parametrize a square (or your favorite shape) in the plane with the same number of points as the boundary.
You will now need to build the cotangent Laplacian. To do this complete the method <code>compute_dirichlet()</code> in the class <code>ConformalParametrization</code> to build the discrete Laplacian. It is allowed to use the methods <code>igl::boundary_loop()</code> and <code>igl::boundary_facets()</code> in the task.</p><h5 id=sparse-matrices-in-eigen>Sparse Matrices in Eigen</h5><p>The matrices of interest will be sparse in our case. Therefore we are using a different datastructure to represent these matrices. Instead of saving every matrix entry, we will only save the non-zero entries with their respective positions and the value of the matrix at this entry.<figure><img src=../../images/conformal_parametrization/sparse_matrices_eigen.png width=70% height=70%></figure></p><p>A sparse matrix with double values can be declared through <code>Eigen::SparseMatrix&lt;double></code>. In order to create such a matrix we need to create Triplets</p><p><code>Eigen::Triplet&lt;double>(row, column, value)</code> and stack them in a vector. Then we can use the method <code>setFromTriplets</code> to fill the sparse matrix. We will need matrices of this type to use the in-build solver.</p><p>We want to solve the Poisson problem with a constraint on the boundary, i.e</p><p>$\Delta u = 0$ where $u\mid_{\partial M} = z_{c\partial M}$</p><p>We recommend to use the camelhead as a shape, since you will need to parametrize only one boundary in this case.</p><figure><img src=../../images/conformal_parametrization/camelhead_to_square.png width=50% height=50%></figure><h5 id=minimization-of-quadratic-energies-in-libigl>Minimization of quadratic energies in Libigl</h5><p>To solve this Poisson problem we need to minimize the Dirichlet energy with the fixed boundary. Libigl has an in-build method to solve these kind of quadratic minimization problems.
For a sparse, symmetric, positive definite $n\times n$ matrix $Q$ (hint: check whether your matrix is really positive definite&mldr;) and a vector $B$, let $\mid \partial M \mid$ be the number of points with constraint. Let $z_{\partial M}$ be a vector of shape $\mid \partial M \mid\times 1$ (not $\mid \partial M \mid\times 2$ !!) that indicate the point numbers with constraint. Let $z_{bc}$ be a vector of shape $\mid \partial M \mid\times 1$ with the constraints for the chosen points. In our cases for this task we can set $A_{eq} = 0$, an empty sparse matrix and $B, B_{eq}$ as zero vectors.</p><p>Then we can solve the minimization problem</p><p>$$\text{min}\ z^t Q z + z^t B\ \text{where}\ z_{\partial M} = z_{bc}\ \text{and} \ A_{eq} z = B_{eq}$$ with the method</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>igl<span style=color:#f92672>::</span>min_quad_with_fixed_data<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span> data;
</span></span><span style=display:flex><span>igl<span style=color:#f92672>::</span>min_quad_with_fixed_precompute(Q, zb, SparseMatrix<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>double</span><span style=color:#f92672>&gt;</span>(),true, data); 
</span></span><span style=display:flex><span>igl<span style=color:#f92672>::</span>min_quad_with_fixed_solve(data,B,zbc,VectorXd(),minimal_z);
</span></span></code></pre></div><p>Task: Modify your Laplacian such that you can use it for this minimizer. Experiment with different boundary shapes.</p><h4 id=bonus>Bonus</h4><p>Solve this problem without the in-build solver and code the constraint minimization yourself.</p><h3 id=conformal-parametrization>Conformal Parametrization</h3><p>With the working Laplacian build a sparse matrix <code>Area</code>, complete the methods <code>build_area</code> with the formula from the lecture and <code>build_conformal_energy</code>.</p><p>In order to do this, note that the area of a discrete mesh can be computed through</p><p>$$\text{Area}(M) = \sum_{e_{ij}\in\partial M} \frac{1}{2} (u_i v_j - u_j v_i)$$</p><figure><img src=../../images/conformal_parametrization/build_area_matrix.png width=50% height=50%></figure><p>From this you should build a matrix $A$ such that</p><p>$$\text{Area}(M) = \begin{pmatrix} u_1,v_1,u_2,v_2,\ldots,u_{|V|},v_{|V|}\end{pmatrix}\cdot A\cdot \begin{pmatrix} u_1,v_1,u_2,v_2,\ldots,u_{|V|},v_{|V|}\end{pmatrix}^T$$
Note: The way to arrange coordinates is not unique! In case you used a different order of coordinates to assemble the Laplacian, you need to be consistent with it.</p><p>In the case of the harmonic parametrization we set a constraint on every vertex on the boundary. To complete the method <code>minimize_energy</code> you will fix the positions of 2 vertices on the boundary. Then modify the constraint minimization of the harmonic parametrization and compute the conformal parametrization.</p><p>Experiment fixing different vertices on the boundary or to place them at different positions<figure><img src=../../images/conformal_parametrization/new_beetle.png width=50% height=50%></figure></p><h4 id=bonus-1>Bonus</h4><p>For now we used the Laplacian with cotangent weights. Try to use a Laplacian with different weights. For example the euclidean distance between adjacent vertices or just the binary information (1 or 0) whether two vertices are connected.</p></div></article></div></main><footer id=site-footer class="bg-dark text-white pb-4 pt-4"><div class=container><div class="copyright text-center">&copy;2022Maths of Glory</div></div></footer><script src=../../js/bootstrap.min.js></script></body></html>